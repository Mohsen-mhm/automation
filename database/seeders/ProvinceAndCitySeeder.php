<?php

namespace Database\Seeders;

use App\Models\Province;
use App\Models\City;
use Illuminate\Database\Seeder;

class ProvinceAndCitySeeder extends Seeder
{
    /**
     * Run the database seeds.
     * Complete list of all 31 Iranian provinces with their major cities
     */
    public function run(): void
    {
        $provincesData = [
            [
                'name' => 'تهران',
                'cities' => [
                    'تهران', 'کرج', 'ورامین', 'شهریار', 'رباط کریم', 'اسلامشهر', 'پاکدشت', 'ملارد',
                    'بهارستان', 'نظرآباد', 'دماوند', 'فیروزکوه', 'پردیس', 'قدس', 'شمیرانات'
                ]
            ],
            [
                'name' => 'البرز',
                'cities' => [
                    'کرج', 'نظرآباد', 'طالقان', 'ساوجبلاغ', 'هشتگرد', 'فردیس', 'محمدشهر',
                    'مشکین دشت', 'آسارا', 'تنکمان', 'چهارباغ'
                ]
            ],
            [
                'name' => 'اصفهان',
                'cities' => [
                    'اصفهان', 'کاشان', 'نجف آباد', 'خمینی شهر', 'شاهین شهر', 'فلاورجان', 'مبارکه',
                    'زرین شهر', 'نایین', 'آران و بیدگل', 'گلپایگان', 'خوانسار', 'اردستان', 'نطنز',
                    'دهاقان', 'تیران و کرون', 'برخوار', 'لنجان', 'شهرضا', 'سمیرم'
                ]
            ],
            [
                'name' => 'فارس',
                'cities' => [
                    'شیراز', 'کازرون', 'لار', 'جهرم', 'مرودشت', 'آباده', 'داراب', 'فسا', 'نی ریز',
                    'فیروزآباد', 'اقلید', 'سپیدان', 'ممسنی', 'لامرد', 'استهبان', 'خرم بید',
                    'قیر و کارزین', 'رستم', 'زرین دشت', 'پاسارگاد'
                ]
            ],
            [
                'name' => 'خراسان رضوی',
                'cities' => [
                    'مشهد', 'نیشابور', 'سبزوار', 'تربت حیدریه', 'کاشمر', 'تربت جام', 'قوچان',
                    'بردسکن', 'چناران', 'خواف', 'طوس', 'فریمان', 'کلات', 'مه ولات', 'رشتخوار',
                    'درگز', 'گناباد', 'باخرز', 'فیروزه'
                ]
            ],
            [
                'name' => 'خوزستان',
                'cities' => [
                    'اهواز', 'آبادان', 'خرمشهر', 'دزفول', 'شوشتر', 'اندیمشک', 'بهبهان', 'ماهشهر',
                    'ایذه', 'شوش', 'رامهرمز', 'آغاجاری', 'گتوند', 'حمیدیه', 'هندیجان', 'باغ ملک',
                    'امیدیه', 'کارون', 'مسجد سلیمان', 'لالی', 'دشت آزادگان', 'هویزه'
                ]
            ],
            [
                'name' => 'آذربایجان شرقی',
                'cities' => [
                    'تبریز', 'مراغه', 'میانه', 'مرند', 'شبستر', 'بناب', 'سراب', 'بستان آباد',
                    'کلیبر', 'عجب شیر', 'ملکان', 'اهر', 'هشترود', 'ورزقان', 'آذرشهر', 'جلفا',
                    'چاراویماق', 'اسکو', 'هریس'
                ]
            ],
            [
                'name' => 'آذربایجان غربی',
                'cities' => [
                    'ارومیه', 'خوی', 'ماکو', 'مهاباد', 'بوکان', 'میاندوآب', 'نقده', 'سلماس',
                    'پیرانشهر', 'شاهین دژ', 'تکاب', 'چالدران', 'پلدشت', 'اشنویه', 'سردشت',
                    'چایپاره', 'شوط'
                ]
            ],
            [
                'name' => 'مازندران',
                'cities' => [
                    'ساری', 'بابل', 'آمل', 'قائم شهر', 'گرگان', 'بابلسر', 'تنکابن', 'نور', 'نوشهر',
                    'رامسر', 'چالوس', 'بهشهر', 'جویبار', 'نکا', 'فریدونکنار', 'گلوگاه', 'کلاردشت',
                    'عباس آباد', 'کیاسر', 'پل سفید', 'سواد کوه'
                ]
            ],
            [
                'name' => 'گیلان',
                'cities' => [
                    'رشت', 'انزلی', 'لاهیجان', 'لنگرود', 'صومعه سرا', 'فومن', 'رودبار', 'آستارا',
                    'ماسال', 'تالش', 'رودسر', 'شفت', 'استانه اشرفیه', 'منجیل', 'سیاهکل',
                    'کلاچای', 'دیلمان', 'رضوانشهر'
                ]
            ],
            [
                'name' => 'کرمان',
                'cities' => [
                    'کرمان', 'رفسنجان', 'سیرجان', 'بم', 'زرند', 'کهنوج', 'بافت', 'راور', 'جیرفت',
                    'شهر بابک', 'انار', 'بردسیر', 'فهرج', 'رودبار جنوب', 'عنبرآباد', 'قلعه گنج',
                    'منوجان', 'فاریاب', 'ریگان', 'نرماشیر'
                ]
            ],
            [
                'name' => 'کردستان',
                'cities' => [
                    'سنندج', 'سقز', 'مریوان', 'بانه', 'کامیاران', 'بیجار', 'قروه', 'دیواندره',
                    'دهگلان', 'سروآباد'
                ]
            ],
            [
                'name' => 'همدان',
                'cities' => [
                    'همدان', 'ملایر', 'تویسرکان', 'نهاوند', 'رزن', 'کبودرآهنگ', 'اسدآباد', 'بهار',
                    'فامنین', 'لالجین'
                ]
            ],
            [
                'name' => 'چهارمحال و بختیاری',
                'cities' => [
                    'شهرکرد', 'بروجن', 'فارسان', 'لردگان', 'سامان', 'گندمان', 'بن', 'اردل',
                    'کوهرنگ', 'کیان'
                ]
            ],
            [
                'name' => 'یزد',
                'cities' => [
                    'یزد', 'میبد', 'اردکان', 'بافق', 'ابرکوه', 'تفت', 'مهریز', 'هرات', 'زارچ',
                    'خضرآباد'
                ]
            ],
            [
                'name' => 'لرستان',
                'cities' => [
                    'خرم آباد', 'بروجرد', 'دورود', 'الیگودرز', 'نورآباد', 'کوهدشت', 'ازنا', 'پلدختر',
                    'چالانچولان', 'رومشکان'
                ]
            ],
            [
                'name' => 'اردبیل',
                'cities' => [
                    'اردبیل', 'پارس آباد', 'خلخال', 'مشگین شهر', 'گرمی', 'نمین', 'نیر', 'کوثر',
                    'بیله سوار', 'سرعین'
                ]
            ],
            [
                'name' => 'ایلام',
                'cities' => [
                    'ایلام', 'دهلران', 'مهران', 'آبدانان', 'دره شهر', 'شیروان چرداول', 'ایوان',
                    'ملکشاهی', 'بدره', 'هلیلان'
                ]
            ],
            [
                'name' => 'بوشهر',
                'cities' => [
                    'بوشهر', 'برازجان', 'گناوه', 'خورموج', 'کنگان', 'دیر', 'دشتی',
                    'دشتستان', 'تنگستان', 'جم', 'عسلویه'
                ]
            ],
            [
                'name' => 'زنجان',
                'cities' => [
                    'زنجان', 'ابهر', 'خدابنده', 'خرمدره', 'طارم', 'ماهنشان', 'سلطانیه', 'ایجرود',
                    'زرین رود', 'قیدار'
                ]
            ],
            [
                'name' => 'سمنان',
                'cities' => [
                    'سمنان', 'شاهرود', 'دامغان', 'گرمسار', 'مهدی شهر', 'بسطام', 'میامی', 'آرادان',
                    'سرخه', 'ایوانکی'
                ]
            ],
            [
                'name' => 'قزوین',
                'cities' => [
                    'قزوین', 'البرز', 'تاکستان', 'بوئین زهرا', 'آوج', 'الوند', 'محمدیه', 'اقبالیه',
                    'ضیاءآباد', 'شال'
                ]
            ],
            [
                'name' => 'قم',
                'cities' => [
                    'قم', 'سلفچگان', 'دستجرد', 'کهک', 'جعفرآباد', 'قنوات', 'کاویان'
                ]
            ],
            [
                'name' => 'گلستان',
                'cities' => [
                    'گرگان', 'گنبد کاووس', 'علی آباد کتول', 'آق قلا', 'کردکوی', 'بندر ترکمن',
                    'آزادشهر', 'رامیان', 'کلاله', 'مینودشت'
                ]
            ],
            [
                'name' => 'خراسان شمالی',
                'cities' => [
                    'بجنورد', 'اسفراین', 'شیروان', 'فاروج', 'جاجرم', 'مانه و سملقان', 'راز و جرگلان',
                    'گرمه', 'پیش قلعه'
                ]
            ],
            [
                'name' => 'خراسان جنوبی',
                'cities' => [
                    'بیرجند', 'قائنات', 'فردوس', 'طبس', 'نهبندان', 'درمیان', 'زیرکوه', 'سرایان',
                    'بشرویه', 'خوسف'
                ]
            ],
            [
                'name' => 'کهگیلویه و بویراحمد',
                'cities' => [
                    'یاسوج', 'گچساران', 'دوگنبدان', 'دنا', 'بهمئی', 'کهگیلویه', 'چرام', 'باشت',
                    'لنده', 'مارگون'
                ]
            ],
            [
                'name' => 'سیستان و بلوچستان',
                'cities' => [
                    'زاهدان', 'زابل', 'چابهار', 'ایرانشهر', 'خاش', 'سراوان', 'نیک شهر', 'کنارک',
                    'راسک', 'قصرقند', 'میرجاوه', 'دلگان', 'فنوج', 'هیرمند', 'نیمروز', 'زهک',
                    'هامون', 'مهرستان'
                ]
            ],
            [
                'name' => 'هرمزگان',
                'cities' => [
                    'بندرعباس', 'بندر لنگه', 'میناب', 'قشم', 'کیش', 'حاجی آباد', 'بستک', 'جاسک',
                    'پارسیان', 'سیریک', 'رودان', 'خمیر', 'گاوبندی', 'ابوموسی'
                ]
            ],
            [
                'name' => 'کرمانشاه',
                'cities' => [
                    'کرمانشاه', 'اسلام آباد غرب', 'کنگاور', 'سنقر', 'هرسین', 'صحنه', 'قصر شیرین',
                    'سرپل ذهاب', 'گیلان غرب', 'داالهو', 'روانسر', 'پاوه', 'جوانرود'
                ]
            ],
            [
                'name' => 'مرکزی',
                'cities' => [
                    'اراک', 'ساوه', 'خمین', 'محلات', 'دلیجان', 'تفرش', 'شازند', 'آشتیان', 'فراهان',
                    'زرندیه', 'کمیجان'
                ]
            ]
        ];

        foreach ($provincesData as $index => $provinceData) {
            // Create province
            $province = Province::create([
                'name' => $provinceData['name'],
                'active' => true,
                'sort_order' => $index + 1
            ]);

            // Remove duplicates from cities array and create cities
            $uniqueCities = array_unique($provinceData['cities']);
            foreach ($uniqueCities as $cityIndex => $cityName) {
                City::create([
                    'province_id' => $province->id,
                    'name' => trim($cityName),
                    'active' => true,
                    'sort_order' => $cityIndex + 1
                ]);
            }
        }

        $this->command->info('All 31 Iranian provinces and their major cities have been seeded successfully!');
        $this->command->info('Total provinces: ' . count($provincesData));
        $this->command->info('Total cities: ' . collect($provincesData)->sum(function($province) {
                return count($province['cities']);
            }));
    }
}
